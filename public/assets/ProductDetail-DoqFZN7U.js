import{u as w,j as s,e as F,B as d,C as U,i as M,k as Q}from"./index-B47FFcJk.js";import{u as p,S as l}from"./skeleton-CnM8Uxyc.js";import{r as m}from"./react-Dneogk0_.js";import{P as T}from"./ProductCard-Df1eoWgp.js";import{f as c,c as t}from"./currency-ByeFX4iW.js";import{c as V,d as q}from"./vendor-DdSLAvpX.js";import{C as z}from"./circle-check-big-CtBp8YHm.js";import{C as b}from"./circle-alert-C4nm64Sn.js";import{M as E,P as B}from"./plus-BPji9f-M.js";import{H as O}from"./heart-DlsrjKFH.js";function D(){const{recentlyViewed:n}=w();return n.length?s.jsxs("div",{className:"mt-12 mb-16",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Recently Viewed"})}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:n.slice(0,4).map(i=>s.jsx(T,{id:i.id,slug:i.slug,name:i.name,imageUrl:i.imageUrl,price:i.price,discountPrice:i.discountPrice,stockLevel:i.stockLevel,isNew:!1},i.id))})]}):null}function ss({params:n}){var N;const{slug:i}=n;V();const[o,x]=m.useState(1),{addToCart:y,isLoading:v}=F(),{addToRecentlyViewed:h}=w(),{data:e,isLoading:k}=p({queryKey:[`/api/products/${i}`]}),{data:r,isLoading:C}=p({queryKey:["/api/products/category",e==null?void 0:e.categoryId],enabled:!!(e!=null&&e.categoryId)});m.useEffect(()=>{e&&typeof e=="object"&&"id"in e&&h({id:typeof e.id=="string"?parseInt(e.id,10):e.id,slug:e.slug,name:e.name,imageUrl:e.imageUrl,price:e.price,discountPrice:e.discountPrice??null,stockLevel:e.stockLevel.toString(),categoryId:Number(e.categoryId)})},[e,h]);const u=q();m.useEffect(()=>{e===null&&u("/not-found")},[e,u]);const P=()=>{if(e){const a=typeof e.id=="string"?parseInt(e.id,10):e.id;y(a,o)}},L=()=>x(a=>a+1),S=()=>x(a=>Math.max(1,a-1)),j=((N=e==null?void 0:e.stockLevel)==null?void 0:N.toString().toLowerCase())||"",g=j==="in stock",I=j==="low stock",R=e!=null&&e.discountPrice&&(e!=null&&e.price)?Math.round((e.price-e.discountPrice)/e.price*100):0;if(k)return s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[s.jsx("div",{className:"md:w-1/2",children:s.jsx(l,{className:"w-full aspect-square rounded-lg"})}),s.jsxs("div",{className:"md:w-1/2",children:[s.jsx(l,{className:"h-10 w-3/4 mb-2"}),s.jsx(l,{className:"h-6 w-1/4 mb-4"}),s.jsx(l,{className:"h-4 w-full mb-2"}),s.jsx(l,{className:"h-4 w-full mb-2"}),s.jsx(l,{className:"h-4 w-3/4 mb-6"}),s.jsx(l,{className:"h-10 w-full"})]})]})});if(!e)return null;const f=r&&Array.isArray(r)?r==null?void 0:r.filter(a=>a.id!==e.id).slice(0,4):[];return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[s.jsx("div",{className:"md:w-1/2",children:s.jsx("div",{className:"bg-white rounded-lg overflow-hidden",children:s.jsx("img",{src:e.imageUrl,alt:e.name,className:"w-full object-cover"})})}),s.jsxs("div",{className:"md:w-1/2",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:e.name}),s.jsx("div",{className:"flex items-center mb-4",children:e.discountPrice?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-2xl text-blue-800 font-bold mr-3",children:c(t(e.discountPrice))}),s.jsx("span",{className:"text-gray-500 text-lg line-through",children:c(t(e.price))}),s.jsxs("span",{className:"ml-2 bg-secondary text-white text-sm font-bold px-2 py-1 rounded",children:[R,"% OFF"]})]}):s.jsx("span",{className:"text-2xl text-blue-800 font-bold",children:c(t(e.price))})}),s.jsx("div",{className:"mb-4",children:g?s.jsxs("span",{className:"text-success flex items-center",children:[s.jsx(z,{className:"h-5 w-5 mr-1"})," In Stock"]}):I?s.jsxs("span",{className:"text-warning flex items-center",children:[s.jsx(b,{className:"h-5 w-5 mr-1"})," Low Stock"]}):s.jsxs("span",{className:"text-error flex items-center",children:[s.jsx(b,{className:"h-5 w-5 mr-1"})," Out of Stock"]})}),s.jsx("p",{className:"text-gray-700 mb-6",children:e.description}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quantity"}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(d,{variant:"outline",size:"icon",className:"rounded-r-none",onClick:S,disabled:o<=1,children:s.jsx(E,{className:"h-4 w-4"})}),s.jsx("div",{className:"px-4 py-2 border-t border-b border-gray-300 text-center w-12",children:o}),s.jsx(d,{variant:"outline",size:"icon",className:"rounded-l-none",onClick:L,children:s.jsx(B,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex gap-2 mb-6",children:[s.jsx(d,{className:"flex-1",size:"lg",onClick:P,disabled:v||!g,children:"Add to Cart"}),s.jsx(d,{variant:"outline",size:"icon",className:"text-gray-500",children:s.jsx(O,{className:"h-5 w-5"})})]}),s.jsx(U,{className:"mt-6",children:s.jsxs(M,{className:"pt-6",children:[s.jsx("h3",{className:"font-bold mb-4",children:"Store Pickup Details"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This item is available for in-store pickup. Once your order is placed, we'll prepare it for pickup at our store."}),s.jsx("p",{className:"text-sm text-gray-700",children:"You'll receive an email notification when your order is ready for pickup, typically within 24 hours."})]})})]})]}),f.length>0&&s.jsxs("div",{className:"mt-12",children:[s.jsx(Q,{className:"mb-6"}),s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"You May Also Like"}),C?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:Array(4).fill(0).map((a,A)=>s.jsxs("div",{className:"aspect-[4/3]",children:[s.jsx(l,{className:"w-full h-full rounded-lg"}),s.jsxs("div",{className:"p-4 space-y-2",children:[s.jsx(l,{className:"h-4 w-3/4"}),s.jsx(l,{className:"h-4 w-1/4"})]})]},A))}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map(a=>s.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition",children:s.jsxs("a",{href:`/product/${a.slug}`,className:"block",children:[s.jsx("div",{className:"aspect-[4/3]",children:s.jsx("img",{src:a.imageUrl,alt:a.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-medium mb-1",children:a.name}),s.jsx("div",{className:"flex items-center",children:a.discountPrice?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-blue-800 font-bold mr-2",children:c(t(a.discountPrice))}),s.jsx("span",{className:"text-gray-500 text-sm line-through",children:c(t(a.price))})]}):s.jsx("span",{className:"text-blue-800 font-bold",children:c(t(a.price))})})]})]})},a.id))})]}),s.jsx(D,{})]})}export{ss as default};
